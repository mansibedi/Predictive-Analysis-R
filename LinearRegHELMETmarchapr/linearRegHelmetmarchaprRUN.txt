> getwd()
[1] "E:/Mansi/Droom"
> train <- read.csv("HELMETmarchapr.csv")
> dim(train)
[1] 34887    70
> library(Hmisc)
> library(caTools)   #split dataset into two sets in ratio of vector specified
> split <- sample.split(train$platform, SplitRatio = 0.75)
> datatrain <- subset(train, split == TRUE)
> datatest <- subset(train, split == FALSE)
> library(plyr)
> datatrain$platform<- revalue(datatrain$platform, c("Android"="0", "App"="1", "Desktop"="2", "IoS"="3", "Mobile Web"="4"))
> datatrain$platform <- as.numeric(as.character(datatrain$platform))
> typeof(datatrain$platform)
[1] "double"
> modeltrain <-lm(takerate~net_revenue+platform, data = datatrain)
> vif(modeltrain)
net_revenue    platform 
    1.00354     1.00354 
> summary(modeltrain)

Call:
lm(formula = takerate ~ net_revenue + platform, data = datatrain)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.48424 -0.00113  0.00313  0.01167  0.06240 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept)  1.455e+00  1.186e-03 1226.26   <2e-16 ***
net_revenue  3.920e-03  7.746e-05   50.61   <2e-16 ***
platform    -4.269e-03  3.678e-04  -11.61   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.0662 on 26161 degrees of freedom
Multiple R-squared:  0.09151,	Adjusted R-squared:  0.09144 
F-statistic:  1318 on 2 and 26161 DF,  p-value: < 2.2e-16

> predictModel <- predict(modeltrain, datatest)
Error: variable 'platform' was fitted with type "numeric" but type "factor" was supplied
> predictModel
       2        3        4       10       11       12       14       16       17       20       21       22 
1.448050 1.506584 1.448050 1.448050 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 
      24       25       26       28       30       31       32       34       35       38       39       41 
1.506584 1.506584 1.448050 1.448050 1.506584 1.506584 1.448050 1.506584 1.506584 1.506584 1.506584 1.506584 
      42       43       44       45       46       47       48       49       51       52       53       54 
1.506584 1.506584 1.448050 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 
      55       56       57       59       60       61       62       64       65       66       68       69 
1.448050 1.448050 1.448050 1.448050 1.448050 1.506584 1.506584 1.506584 1.506584 1.506584 1.448050 1.448050 
      70       71       74       75       76       77       78       80       81       82       85       87 
1.448050 1.506584 1.506584 1.448050 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.448050 
      88       89       91       93       94       95       96       98      100      101      102      103 
1.448050 1.448050 1.448050 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.448050 1.448050 
     104      107      108      110      111      112      113      115      117      118      119      121 
1.448050 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.448050 1.506584 1.506584 1.506584 1.506584 
     122      123      124      125      126      129      132      134      135      136      138      139 
1.506584 1.506584 1.448050 1.506584 1.448050 1.506584 1.506584 1.506584 1.448050 1.506584 1.506584 1.506584 
     140      142      143      145      146      148      149      150      151      153      154      155 
1.506584 1.448050 1.506584 1.506584 1.506584 1.506584 1.506584 1.448050 1.506584 1.506584 1.506584 1.506584 
     158      159      160      161      163      165      168      169      170      171      172      173 
1.448050 1.506584 1.448050 1.506584 1.506584 1.448050 1.506584 1.448050 1.448050 1.506584 1.448050 1.506584 
     174      175      176      177      178      179      180      182      183      185      187      188 
1.506584 1.448050 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.448050 1.448050 
     189      190      191      192      194      196      198      199      200      201      202      203 
1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.448050 1.448050 1.448050 1.448050 1.448050 1.506584 
     204      206      207      208      209      211      213      214      215      216      217      218 
1.506584 1.506584 1.506584 1.448050 1.506584 1.448050 1.448050 1.506584 1.506584 1.506584 1.506584 1.448050 
     219      220      221      222      223      224      227      230      231      233      234      235 
1.448050 1.448050 1.506584 1.506584 1.506584 1.448050 1.448050 1.506584 1.448050 1.506584 1.448050 1.506584 
     236      237      238      239      240      241      243      244      245      246      248      249 
1.506584 1.448050 1.506584 1.448050 1.506584 1.506584 1.448050 1.506584 1.506584 1.506584 1.506584 1.506584 
     251      253      254      255      256      257      258      259      260      261      262      263 
1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.448050 1.506584 1.506584 1.506584 1.506584 1.506584 
     264      266      267      268      269      270      271      272      273      274      277      278 
1.506584 1.506584 1.448050 1.506584 1.506584 1.506584 1.506584 1.448050 1.506584 1.506584 1.506584 1.448050 
     279      280      282      284      285      286      288      290      291      293      296      297 
1.506584 1.506584 1.448050 1.506584 1.448050 1.506584 1.448050 1.448050 1.506584 1.506584 1.448050 1.506584 
     299      300      302      303      304      305      306      307      308      309      310      311 
1.448050 1.506584 1.448050 1.506584 1.448050 1.506584 1.506584 1.448050 1.506584 1.506584 1.506584 1.448050 
     313      314      315      316      317      319      320      321      323      324      325      326 
1.448050 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.448050 1.448050 1.506584 1.506584 1.506584 
     327      328      329      333      334      335      336      337      338      340      343      344 
1.448050 1.448050 1.448050 1.506584 1.506584 1.448050 1.506584 1.506584 1.506584 1.448050 1.506584 1.506584 
     345      346      347      350      351      352      353      354      355      356      357      358 
1.448050 1.448050 1.506584 1.506584 1.448050 1.506584 1.448050 1.506584 1.506584 1.448050 1.506584 1.448050 
     359      360      363      364      365      366      367      368      369      370      372      373 
1.448050 1.506584 1.506584 1.506584 1.506584 1.448050 1.448050 1.506584 1.506584 1.506584 1.506584 1.448050 
     374      375      377      378      379      380      381      382      383      386      388      389 
1.448050 1.506584 1.448050 1.506584 1.506584 1.448050 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 
     392      393      394      395      400      401      402      403      405      406      407      408 
1.448050 1.448050 1.448050 1.506584 1.448050 1.448050 1.448050 1.506584 1.448050 1.448050 1.506584 1.506584 
     410      411      416      417      419      420      421      423      424      425      426      427 
1.506584 1.506584 1.506584 1.506584 1.506584 1.448050 1.506584 1.506584 1.506584 1.448050 1.506584 1.506584 
     429      430      433      434      435      436      437      441      442      444      445      446 
1.506584 1.448050 1.506584 1.448050 1.506584 1.448050 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 
     447      448      451      454      455      456      457      458      459      460      461      462 
1.506584 1.506584 1.506584 1.506584 1.448050 1.506584 1.506584 1.448050 1.506584 1.506584 1.448050 1.506584 
     463      464      466      467      469      470      472      473      475      476      477      478 
1.506584 1.506584 1.506584 1.448050 1.448050 1.506584 1.506584 1.506584 1.448050 1.448050 1.448050 1.506584 
     479      480      481      482      483      485      487      489      491      492      493      494 
1.506584 1.448050 1.506584 1.506584 1.448050 1.448050 1.506584 1.448050 1.506584 1.448050 1.448050 1.506584 
     495      496      498      499      500      501      502      503      504      507      509      510 
1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 
     511      512      513      514      516      518      519      520      521      523      525      527 
1.506584 1.506584 1.448050 1.448050 1.506584 1.506584 1.448050 1.506584 1.506584 1.448050 1.448050 1.448050 
     528      529      530      531      532      533      534      536      538      539      541      542 
1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.448050 1.506584 1.506584 
     543      544      545      547      548      549      550      551      553      554      556      557 
1.448050 1.448050 1.506584 1.448050 1.506584 1.506584 1.506584 1.506584 1.448050 1.506584 1.448050 1.448050 
     559      562      563      564      565      566      567      568      574      575      576      577 
1.506584 1.448050 1.448050 1.506584 1.448050 1.506584 1.506584 1.506584 1.448050 1.506584 1.506584 1.448050 
     578      580      581      582      583      584      587      588      590      592      593      594 
1.506584 1.506584 1.506584 1.506584 1.448050 1.448050 1.506584 1.448050 1.448050 1.506584 1.506584 1.506584 
     595      596      598      599      600      601      602      603      604      605      606      607 
1.448050 1.448050 1.506584 1.506584 1.506584 1.506584 1.448050 1.506584 1.506584 1.506584 1.448050 1.506584 
     608      609      610      611      612      613      614      615      618      620      621      623 
1.506584 1.448050 1.506584 1.506584 1.506584 1.448050 1.506584 1.448050 1.506584 1.506584 1.506584 1.448050 
     624      625      626      627      628      629      630      631      636      637      639      640 
1.506584 1.448050 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.448050 1.506584 1.448050 1.506584 
     641      642      643      644      645      646      647      651      652      653      655      656 
1.506584 1.448050 1.506584 1.506584 1.506584 1.506584 1.448050 1.506584 1.506584 1.506584 1.506584 1.448050 
     657      659      660      661      663      664      665      666      667      668      669      670 
1.506584 1.448050 1.506584 1.506584 1.506584 1.448050 1.506584 1.506584 1.448050 1.506584 1.506584 1.506584 
     671      672      674      676      677      678      679      682      683      684      685      686 
1.506584 1.506584 1.506584 1.506584 1.506584 1.448050 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 
     687      688      689      690      691      693      694      696      697      698      699      700 
1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.448050 1.448050 1.506584 1.506584 
     701      702      704      705      706      708      709      710      711      713      714      716 
1.506584 1.506584 1.506584 1.506584 1.448050 1.506584 1.448050 1.448050 1.448050 1.506584 1.506584 1.506584 
     717      719      720      721      722      723      724      725      726      727      729      730 
1.506584 1.506584 1.448050 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 
     731      732      735      736      738      739      740      741      742      743      744      745 
1.506584 1.506584 1.448050 1.506584 1.506584 1.506584 1.506584 1.448050 1.506584 1.448050 1.506584 1.506584 
     746      747      748      752      753      754      755      756      758      759      760      762 
1.506584 1.506584 1.506584 1.448050 1.506584 1.506584 1.448050 1.506584 1.506584 1.506584 1.448050 1.506584 
     763      764      765      766      767      769      770      771      772      773      774      775 
1.506584 1.506584 1.506584 1.448050 1.506584 1.506584 1.506584 1.506584 1.448050 1.506584 1.506584 1.448050 
     776      777      779      780      781      782      783      785      786      787      788      789 
1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.448050 
     790      792      794      795      796      797      798      799      802      803      804      805 
1.506584 1.448050 1.506584 1.506584 1.506584 1.448050 1.448050 1.506584 1.506584 1.448050 1.506584 1.448050 
     806      807      810      811      812      815      816      817      818      819      820      821 
1.448050 1.506584 1.506584 1.448050 1.506584 1.448050 1.506584 1.448050 1.448050 1.506584 1.448050 1.506584 
     822      824      825      826      828      829      831      832      834      836      837      838 
1.506584 1.506584 1.506584 1.506584 1.448050 1.506584 1.448050 1.506584 1.506584 1.506584 1.448050 1.448050 
     840      843      844      845      846      848      849      851      852      853      855      856 
1.448050 1.448050 1.506584 1.506584 1.448050 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 
     857      858      859      860      861      862      863      865      866      867      868      869 
1.506584 1.506584 1.448050 1.506584 1.506584 1.448050 1.506584 1.506584 1.506584 1.506584 1.506584 1.448050 
     872      873      874      875      877      878      879      881      882      883      884      885 
1.506584 1.448050 1.506584 1.506584 1.506584 1.506584 1.448050 1.448050 1.506584 1.506584 1.506584 1.506584 
     886      887      889      890      892      893      894      895      896      897      898      899 
1.506584 1.506584 1.506584 1.448050 1.448050 1.506584 1.448050 1.506584 1.506584 1.448050 1.506584 1.506584 
     901      902      904      905      906      907      908      912      913      915      916      917 
1.506584 1.506584 1.506584 1.506584 1.448050 1.506584 1.506584 1.506584 1.506584 1.448050 1.448050 1.506584 
     919      923      925      926      928      929      930      931      932      933      934      935 
1.506584 1.448050 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.448050 1.448050 1.506584 1.506584 
     937      938      939      940      942      943      946      947      948      949      950      951 
1.448050 1.506584 1.506584 1.506584 1.448050 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 
     953      954      956      957      960      961      962      963      964      965      966      971 
1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 
     972      973      974      975      976      977      979      980      981      982      983      984 
1.506584 1.506584 1.506584 1.506584 1.448050 1.506584 1.448050 1.506584 1.506584 1.506584 1.506584 1.448050 
     985      987      988      989      990      991      992      993      994      996      997      998 
1.506584 1.506584 1.506584 1.506584 1.506584 1.448050 1.448050 1.506584 1.448050 1.448050 1.506584 1.506584 
     999     1000     1001     1002     1004     1005     1006     1007     1010     1013     1014     1015 
1.506584 1.506584 1.506584 1.506584 1.448050 1.506584 1.506584 1.506584 1.448050 1.448050 1.448050 1.506584 
    1016     1017     1018     1020     1021     1022     1023     1025     1026     1027     1028     1033 
1.448050 1.448050 1.448050 1.506584 1.448050 1.506584 1.506584 1.506584 1.448050 1.506584 1.506584 1.506584 
    1034     1037     1038     1039     1040     1042     1045     1046     1047     1050     1051     1052 
1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 
    1053     1055     1056     1057     1058     1059     1060     1061     1062     1063     1064     1065 
1.506584 1.506584 1.448050 1.506584 1.448050 1.506584 1.506584 1.506584 1.448050 1.506584 1.506584 1.506584 
    1066     1067     1068     1069     1070     1071     1072     1073     1074     1075     1076     1078 
1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.448050 1.506584 1.506584 1.506584 1.448050 1.448050 
    1081     1082     1083     1085     1086     1087     1089     1090     1091     1092     1093     1094 
1.448050 1.448050 1.506584 1.506584 1.448050 1.448050 1.448050 1.506584 1.448050 1.448050 1.506584 1.506584 
    1096     1097     1098     1100     1102     1103     1104     1105     1106     1107     1108     1110 
1.506584 1.448050 1.506584 1.506584 1.448050 1.506584 1.506584 1.506584 1.506584 1.506584 1.448050 1.506584 
    1112     1113     1115     1116     1117     1119     1122     1123     1125     1126     1128     1129 
1.506584 1.506584 1.506584 1.506584 1.506584 1.448050 1.506584 1.448050 1.506584 1.506584 1.506584 1.506584 
    1131     1132     1133     1134     1136     1137     1138     1139     1141     1143     1144     1146 
1.448050 1.506584 1.448050 1.506584 1.448050 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 
    1147     1149     1150     1151     1152     1153     1154     1155     1156     1157     1158     1159 
1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.448050 1.448050 
    1160     1161     1162     1163     1164     1166     1167     1168     1169     1170     1171     1172 
1.448050 1.506584 1.506584 1.506584 1.448050 1.448050 1.506584 1.506584 1.448050 1.506584 1.448050 1.506584 
    1173     1174     1175     1176     1177     1178     1179     1180     1182     1183     1184     1185 
1.448050 1.506584 1.448050 1.448050 1.448050 1.448050 1.448050 1.506584 1.448050 1.506584 1.448050 1.506584 
    1186     1187     1189     1190     1191     1192     1193     1195     1196     1197     1198     1199 
1.448050 1.506584 1.506584 1.506584 1.506584 1.448050 1.506584 1.448050 1.506584 1.506584 1.448050 1.506584 
    1200     1201     1202     1203     1204     1205     1206     1207     1208     1209     1211     1214 
1.448050 1.506584 1.506584 1.506584 1.506584 1.448050 1.506584 1.506584 1.506584 1.448050 1.506584 1.506584 
    1218     1219     1220     1221     1222     1223     1224     1225     1226     1227     1228     1229 
1.506584 1.448050 1.448050 1.448050 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 
    1230     1231     1234     1236     1237     1238     1239     1240     1241     1242     1243     1244 
1.506584 1.506584 1.506584 1.506584 1.506584 1.448050 1.506584 1.506584 1.448050 1.448050 1.506584 1.448050 
    1245     1246     1247     1250     1251     1253     1254     1255     1256     1257     1259     1261 
1.448050 1.506584 1.506584 1.448050 1.448050 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 
    1264     1266     1268     1270     1271     1272     1273     1274     1275     1277     1278     1279 
1.448050 1.506584 1.506584 1.448050 1.506584 1.506584 1.448050 1.506584 1.506584 1.506584 1.506584 1.448050 
    1280     1281     1282     1284     1286     1287     1289     1290     1292     1293     1294     1295 
1.506584 1.448050 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 1.506584 
    1296     1297     1298     1299     1300     1301     1302     1303     1304     1306     1307     1308 
1.448050 1.448050 1.448050 1.506584 1.506584 1.448050 1.506584 1.448050 1.448050 1.448050 1.506584 1.506584 
    1309     1310     1312     1313     1314     1316     1317     1318     1320     1322     1323     1324 
1.448050 1.448050 1.506584 1.506584 1.506584 1.506584 1.506584 1.448050 1.506584 1.506584 1.506584 1.506584 
    1325     1326     1327     1328 
1.506584 1.506584 1.506584 1.506584 
 [ reached getOption("max.print") -- omitted 25164 entries ]
> plot(datatest$takerate, type = "l", lty= 1.8, col="green")  #plotting actual data
> lines(predictModel, type= "l", col= "blue")  #plotting predicted data